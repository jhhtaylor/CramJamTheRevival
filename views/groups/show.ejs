<% layout('layouts/boilerplate') -%>
<div class="container">
    
    <div class="card mb-3">
        <h4><%= group.name %></h4>
        <h5>Group members</h5>
        <% for (var i = 0; i < group.members.length; i++) { %>
            <li> <%= group.members[i]%> <form class="d-inline" action="/groups/<%=group._id%>/edit/<%=group.members[i]._id%>?_method=DELETE" method="POST">
                <button>Remove</button>
            </form>
                <% const raters = (group.members[i].rating.map(e => e.rater)) %> 
                <% if(!group.members[i]._id.equals(signedInUser._id) && !raters.includes(signedInUser._id)) { %>
                <form action="/students/vote/<%=group.members[i]._id%>/" method="POST" class="w-25 p-3 d-inline-flex">
                    <input type="number" name="rating" id="rating" class="form-control" max="5" min="0">
                    <button class="btn btn-primary">Rate</button>
                </form>
                <% } %> 
            </li>
        <% } %>
        <h5>Pending invites</h5>
        <% for (var i = 0; i < group.invites.length; i++) { %>
            <li> <%= group.invites[i]%> </li>
        <% } %>

        <div>
            <a class="btn btn-primary" href="/groups/<%=group._id%>/explore"> Invite new members </a>
        </div>
    </div>
    <!-- Jon: Add new group member hard-coded -->
    <div>
        <h4>Add new group member</h4>
        <form action="/groups/<%=group._id%>/new/member=test" method="POST"> 
            <!-- <input type = "text" name="member" placeholder="User Name"> -->
            <button>Add</button>
        </form>
    </div>
    <!--  -->
    <form class="d-inline" action="/groups/<%=group._id%>?_method=DELETE" method="POST">
        <button>Delete Group</button>
    </form>

</div>

